{% extends 'base.html.twig' %}

{% block title %}Espace utilisateur - EcoRide{% endblock %}

{% block body %}
<main class="pt-5 mt-5 flex-grow-1">
    <div class="container profile-layout bg-eco-green text-eco-cream p-4 rounded shadow">

        <h1 class="text-center mb-5">Espace utilisateur</h1>

        <div class="row">
            <!-- Colonne gauche -->
            <div class="col-12 col-lg-4 text-center mb-4 mb-lg-0 d-flex flex-column align-items-center">
                <img src="{{ user.photoUrl ? asset(user.photoUrl) :asset('uploads/users/default_profil.png') }}"
                        alt="Photo de profil"
                        class="rounded-circle mb-2"
                        style="width: 100px; height: 100px; object-fit: cover;">

                {% set average = average ?? 0 %}
                {% set fullLeaves = average|round(0, 'floor') %}
                <div class="leaf-rating mb-2" style="font-size: 1.2rem;">
                    {% if fullLeaves > 0 %}
                    {% for i in 1..fullLeaves %}
                    üåø
                    {% endfor %}
                    {% for i in 1..(5 - fullLeaves) %}
                    <span class="text-muted">üåø</span>
                    {% endfor %}
                    {% endif %}
                </div>

                <div class="d-flex flex-column align-items-center gap-2 mt-3">
                <a href="{#{{ path('app_historique') }}#}" class="btn btn-eco px-4 py-2 rounded-pill fw-bold btn-responsive w-100 text-center">
                    Historique covoiturage
                </a>
                <a href="{{ path('app_user_profile') }}"
                        class="btn btn-eco px-4 py-2 rounded-pill fw-bold btn-responsive w-100 text-center">
                        Modifier mon compte
                </a>
                {% if user.isDriver %}
                <a href="{#{{ path('app_publier_trajet') }}#}"
                        class="btn btn-eco px-4 py-2 rounded-pill fw-bold btn-responsive w-100 text-center">
                        Publier un trajet
                </a>
                <a href="{{ path('app_vehicle') }}"
                        class="btn btn-eco px-4 py-2 rounded-pill fw-bold btn-responsive w-100 text-center">
                        Ajouter un vehicule
                </a>
                <a href="{#{{ path('app_publier_trajet') }}#}"
                        class="btn btn-eco px-4 py-2 rounded-pill fw-bold btn-responsive w-100 text-center">
                        Modifier mes pr√©f√©rences
                </a>
                {% endif %}
                </div>
            </div>

            <!-- Colonne droite -->
            <section class="col-12 col-lg-8 d-flex flex-column gap-3">
                <div class="section-user-box">
                    <span>Pseudo</span>
                    <span>{{ user.username }}</span>
                </div>
                <div class="section-user-box">
                    <span>Nom</span>
                    <span>{{ user.firstname }}</span>
                </div>
                <div class="section-user-box">
                    <span>Pr√©nom</span>
                    <span>{{ user.surname }}</span>
                </div>
                <div class="section-user-box">
                    <span>Email</span>
                    <span>{{ user.email }}</span>
                </div>
                <div class="section-user-box">
                    <span>n¬∞t√©l√©phone</span>
                    <span>{{ user.phone }}</span>
                </div>
                <div class="section-user-box">
                    <span>Date de naissance</span>
                    <span>
                        {{ user.datebirth ? user.datebirth|date('d/m/Y') : 'Non renseign√©e' }}
                    </span>
                </div>
                <div class="section-user-box">
                    <span>Cr√©dits restants</span>
                    <span>{{ user.credit ?? 0 }} cr√©dits</span>
                </div>
            </section>
            {% if vehicles|length > 0 %}
            <section class="mt-5">
            <h2 class="text-center mb-4">Mes v√©hicules</h2>

            <div class="row row-cols-1 row-cols-md-2 g-4 justify-content-center">
                {% for vehicle in vehicles %}
                    <div class="col">
                        <div class="card bg-eco-cream text-eco-green shadow-sm h-100">
                            <div class="card-body">
                                <h5 class="card-title">{{ vehicle.brand }} {{ vehicle.model }}</h5>
                                <ul class="list-unstyled small mb-0">
                                    <li><strong>Plaque :</strong> {{ vehicle.plate }}</li>
                                    <li><strong>Couleur :</strong> {{ vehicle.color }}</li>
                                    <li><strong>√ânergie :</strong> {{ vehicle.energyType.value|capitalize }}</li>
                                    <li><strong>Si√®ges :</strong> {{ vehicle.seatsTotal }}</li>
                                    <li><strong>1re immatriculation :</strong> {{ vehicle.firstRegistration|date('d/m/Y') }}</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                {% endfor %}
                </div>
                {% endif %}
            </section>
        </div>
    </div>
</main>


{% endblock %}
